
BEGIN
    BEGIN TRANSACTION;
        DELETE FROM RAW.DYN.EMAIL;
        
        INSERT INTO RAW.DYN.EMAIL (
            "@ODATA.ETAG",
            ACTIVITYADDITIONALPARAMS,
            ACTIVITYID,
            ACTIVITYTYPECODE,
            ACTUALDURATIONMINUTES,
            ACTUALEND,
            ACTUALSTART,
            ATTACHMENTCOUNT,
            ATTACHMENTOPENCOUNT,
            BASECONVERSATIONINDEXHASH,
            CATEGORY,
            COMMUNITY,
            COMPRESSED,
            CONVERSATIONINDEX,
            CONVERSATIONTRACKINGID,
            CORRELATIONMETHOD,
            CREATEDON,
            DELAYEDEMAILSENDTIME,
            DELIVERYATTEMPTS,
            DELIVERYLASTATTEMPTEDON,
            DELIVERYPRIORITYCODE,
            DELIVERYRECEIPTREQUESTED,
            DIRECTIONCODE,
            EMAILREMINDEREXPIRYTIME,
            EMAILREMINDERSTATUS,
            EMAILREMINDERTEXT,
            EMAILREMINDERTYPE,
            EMAILTRACKINGID,
            EXCHANGEITEMID,
            EXCHANGERATE,
            EXCHANGEWEBLINK,
            FOLLOWEMAILUSERPREFERENCE,
            IMPORTSEQUENCENUMBER,
            INREPLYTO,
            INSTANCETYPECODE,
            ISBILLED,
            ISEMAILFOLLOWED,
            ISEMAILREMINDERSET,
            ISMAPIPRIVATE,
            ISREGULARACTIVITY,
            ISUNSAFE,
            ISWORKFLOWCREATED,
            LASTONHOLDTIME,
            LASTOPENEDTIME,
            LEFTVOICEMAIL,
            LINKSCLICKEDCOUNT,
            MESSAGEID,
            MIMETYPE,
            MODIFIEDON,
            NOTIFICATIONS,
            ONHOLDTIME,
            OPENCOUNT,
            OVERRIDDENCREATEDON,
            POSTPONEACTIVITYPROCESSINGUNTIL,
            POSTPONEEMAILPROCESSINGUNTIL,
            PRIORITYCODE,
            PROCESSID,
            READRECEIPTREQUESTED,
            REMINDERACTIONCARDID,
            REPLYCOUNT,
            SAFEDESCRIPTION,
            SCHEDULEDDURATIONMINUTES,
            SCHEDULEDEND,
            SCHEDULEDSTART,
            SENDER,
            SENTON,
            SERIESID,
            SORTDATE,
            STAGEID,
            STATECODE,
            STATUSCODE,
            SUBCATEGORY,
            SUBJECT,
            SUBMITTEDBY,
            TIMEZONERULEVERSIONNUMBER,
            TORECIPIENTS,
            TRACKINGTOKEN,
            TRAVERSEDPATH,
            UTCCONVERSIONTIMEZONECODE,
            VERSIONNUMBER,
            _OWNERID_VALUE,
            _SENDERMAILBOXID_VALUE,
            _MODIFIEDBY_VALUE,
            _OWNINGBUSINESSUNIT_VALUE,
            _CREATEDBY_VALUE,
            _OWNINGUSER_VALUE,
            _SLAID_VALUE,
            _TRANSACTIONCURRENCYID_VALUE,
            _REGARDINGOBJECTID_VALUE,
            _SERVICEID_VALUE,
            _MODIFIEDONBEHALFBY_VALUE,
            _SLAINVOKEDID_VALUE,
            _CREATEDONBEHALFBY_VALUE,
            _OWNINGTEAM_VALUE,
            _EMAILSENDER_VALUE,
            _SENDERSACCOUNT_VALUE,
            _TEMPLATEID_VALUE,
            _CORRELATEDACTIVITYID_VALUE,
            _RECEIVINGMAILBOXID_VALUE,
            _PARENTACTIVITYID_VALUE,
            LOAD_TS
        ) 
            SELECT
                VAR:"@odata.etag"::VARCHAR(16777216),
                VAR:activityadditionalparams::VARCHAR(16777216),
                VAR:activityid::VARCHAR(16777216),
                VAR:activitytypecode::VARCHAR(16777216),
                VAR:actualdurationminutes::NUMBER,
                VAR:actualend::NUMBER,
                VAR:actualstart::VARCHAR(16777216),
                VAR:attachmentcount::NUMBER,
                VAR:attachmentopencount::VARCHAR(16777216),
                VAR:baseconversationindexhash::NUMBER,
                VAR:category::VARCHAR(16777216),
                VAR:community::VARCHAR(16777216),
                VAR:compressed::BOOLEAN,
                VAR:conversationindex::VARCHAR(16777216),
                VAR:conversationtrackingid::VARCHAR(16777216),
                VAR:correlationmethod::NUMBER,
                VAR:createdon::NUMBER,
                VAR:delayedemailsendtime::VARCHAR(16777216),
                VAR:deliveryattempts::NUMBER,
                VAR:deliverylastattemptedon::VARCHAR(16777216),
                VAR:deliveryprioritycode::NUMBER,
                VAR:deliveryreceiptrequested::BOOLEAN,
                VAR:directioncode::BOOLEAN,
                VAR:emailreminderexpirytime::VARCHAR(16777216),
                VAR:emailreminderstatus::NUMBER,
                VAR:emailremindertext::VARCHAR(16777216),
                VAR:emailremindertype::NUMBER,
                VAR:emailtrackingid::VARCHAR(16777216),
                VAR:exchangeitemid::VARCHAR(16777216),
                VAR:exchangerate::VARCHAR(16777216),
                VAR:exchangeweblink::VARCHAR(16777216),
                VAR:followemailuserpreference::BOOLEAN,
                VAR:importsequencenumber::VARCHAR(16777216),
                VAR:inreplyto::VARCHAR(16777216),
                VAR:instancetypecode::VARCHAR(16777216),
                VAR:isbilled::BOOLEAN,
                VAR:isemailfollowed::BOOLEAN,
                VAR:isemailreminderset::BOOLEAN,
                VAR:ismapiprivate::VARCHAR(16777216),
                VAR:isregularactivity::BOOLEAN,
                VAR:isunsafe::NUMBER,
                VAR:isworkflowcreated::BOOLEAN,
                VAR:lastonholdtime::VARCHAR(16777216),
                VAR:lastopenedtime::VARCHAR(16777216),
                VAR:leftvoicemail::VARCHAR(16777216),
                VAR:linksclickedcount::VARCHAR(16777216),
                VAR:messageid::VARCHAR(16777216),
                VAR:mimetype::VARCHAR(16777216),
                VAR:modifiedon::NUMBER,
                VAR:notifications::NUMBER,
                VAR:onholdtime::VARCHAR(16777216),
                VAR:opencount::VARCHAR(16777216),
                VAR:overriddencreatedon::VARCHAR(16777216),
                VAR:postponeactivityprocessinguntil::VARCHAR(16777216),
                VAR:postponeemailprocessinguntil::NUMBER,
                VAR:prioritycode::NUMBER,
                VAR:processid::VARCHAR(16777216),
                VAR:readreceiptrequested::BOOLEAN,
                VAR:reminderactioncardid::VARCHAR(16777216),
                VAR:replycount::VARCHAR(16777216),
                VAR:safedescription::VARCHAR(16777216),
                VAR:scheduleddurationminutes::NUMBER,
                VAR:scheduledend::NUMBER,
                VAR:scheduledstart::NUMBER,
                VAR:sender::VARCHAR(16777216),
                VAR:senton::NUMBER,
                VAR:seriesid::VARCHAR(16777216),
                VAR:sortdate::VARCHAR(16777216),
                VAR:stageid::VARCHAR(16777216),
                VAR:statecode::NUMBER,
                VAR:statuscode::NUMBER,
                VAR:subcategory::VARCHAR(16777216),
                VAR:subject::VARCHAR(16777216),
                VAR:submittedby::VARCHAR(16777216),
                VAR:timezoneruleversionnumber::NUMBER,
                VAR:torecipients::VARCHAR(16777216),
                VAR:trackingtoken::VARCHAR(16777216),
                VAR:traversedpath::VARCHAR(16777216),
                VAR:utcconversiontimezonecode::VARCHAR(16777216),
                VAR:versionnumber::NUMBER,
                VAR:_ownerid_value::VARCHAR(16777216),
                VAR:_sendermailboxid_value::VARCHAR(16777216),
                VAR:_modifiedby_value::VARCHAR(16777216),
                VAR:_owningbusinessunit_value::VARCHAR(16777216),
                VAR:_createdby_value::VARCHAR(16777216),
                VAR:_owninguser_value::VARCHAR(16777216),
                VAR:_slaid_value::VARCHAR(16777216),
                VAR:_transactioncurrencyid_value::VARCHAR(16777216),
                VAR:_regardingobjectid_value::VARCHAR(16777216),
                VAR:_serviceid_value::VARCHAR(16777216),
                VAR:_modifiedonbehalfby_value::VARCHAR(16777216),
                VAR:_slainvokedid_value::VARCHAR(16777216),
                VAR:_createdonbehalfby_value::VARCHAR(16777216),
                VAR:_owningteam_value::VARCHAR(16777216),
                VAR:_emailsender_value::VARCHAR(16777216),
                VAR:_sendersaccount_value::VARCHAR(16777216),
                VAR:_templateid_value::VARCHAR(16777216),
                VAR:_correlatedactivityid_value::VARCHAR(16777216),
                VAR:_receivingmailboxid_value::VARCHAR(16777216),
                VAR:_parentactivityid_value::VARCHAR(16777216),
                SYSDATE()
            FROM 
                RAW.DYN.LOAD_EMAIL_STREAM;
    COMMIT;
END