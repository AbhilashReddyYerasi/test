BEGIN
    BEGIN TRANSACTION;
        DELETE FROM RAW.DYN.TASK;
        
        INSERT INTO RAW.DYN.TASK (
            "@ODATA.ETAG",
            STATECODE,
            SCHEDULEDDURATIONMINUTES,
            _REGARDINGOBJECTID_VALUE,
            ACTIVITYTYPECODE,
            CREATEDON,
            ISBILLED,
            SUBJECT,
            _OWNERID_VALUE,
            NEW_ALLOCATEDTIME,
            MODIFIEDON,
            PERCENTCOMPLETE,
            VERSIONNUMBER,
            PRIORITYCODE,
            SCHEDULEDSTART,
            TIMEZONERULEVERSIONNUMBER,
            ISREGULARACTIVITY,
            _MODIFIEDBY_VALUE,
            SCHEDULEDEND,
            STATUSCODE,
            ISWORKFLOWCREATED,
            _CREATEDBY_VALUE,
            ACTUALEND,
            _OWNINGBUSINESSUNIT_VALUE,
            _OWNINGUSER_VALUE,
            ACTIVITYID,
            ACTUALDURATIONMINUTES,
            ONHOLDTIME,
            _SLAID_VALUE,
            LEFTVOICEMAIL,
            SERIESID,
            INSTANCETYPECODE,
            ACTUALSTART,
            EXCHANGEITEMID,
            _TRANSACTIONCURRENCYID_VALUE,
            STAGEID,
            DELIVERYPRIORITYCODE,
            POSTPONEACTIVITYPROCESSINGUNTIL,
            SENTON,
            _SERVICEID_VALUE,
            ACTIVITYADDITIONALPARAMS,
            _MODIFIEDONBEHALFBY_VALUE,
            EXCHANGERATE,
            COMMUNITY,
            _SLAINVOKEDID_VALUE,
            UTCCONVERSIONTIMEZONECODE,
            ISMAPIPRIVATE,
            PROCESSID,
            _CREATEDONBEHALFBY_VALUE,
            EXCHANGEWEBLINK,
            LASTONHOLDTIME,
            DELIVERYLASTATTEMPTEDON,
            _SENDERMAILBOXID_VALUE,
            DESCRIPTION,
            TRAVERSEDPATH,
            SORTDATE,
            _OWNINGTEAM_VALUE,
            MSDYNCRM_ACTIVITYID,
            OVERRIDDENCREATEDON,
            _MSDYNCRM_ASSOCIATEDCUSTOMERJOURNEYITERATION_VALUE,
            SUBCATEGORY,
            CATEGORY,
            CRMTASKASSIGNEDUNIQUEID,
            IMPORTSEQUENCENUMBER,
            SUBSCRIPTIONID,
            LOAD_TS
        )
            SELECT
                VAR:"@odata.etag"::VARCHAR(16777216),
                VAR:statecode::NUMBER,
                VAR:scheduleddurationminutes::NUMBER,
                VAR:_regardingobjectid_value::VARCHAR(16777216),
                VAR:activitytypecode::VARCHAR(16777216),
                VAR:createdon::NUMBER,
                VAR:isbilled::BOOLEAN,
                VAR:subject::VARCHAR(16777216),
                VAR:_ownerid_value::VARCHAR(16777216),
                VAR:new_allocatedtime::VARCHAR(16777216),
                VAR:modifiedon::NUMBER,
                VAR:percentcomplete::NUMBER,
                VAR:versionnumber::NUMBER,
                VAR:prioritycode::NUMBER,
                VAR:scheduledstart::NUMBER,
                VAR:timezoneruleversionnumber::NUMBER,
                VAR:isregularactivity::BOOLEAN,
                VAR:_modifiedby_value::VARCHAR(16777216),
                VAR:scheduledend::NUMBER,
                VAR:statuscode::NUMBER,
                VAR:isworkflowcreated::BOOLEAN,
                VAR:_createdby_value::VARCHAR(16777216),
                VAR:actualend::NUMBER,
                VAR:_owningbusinessunit_value::VARCHAR(16777216),
                VAR:_owninguser_value::VARCHAR(16777216),
                VAR:activityid::VARCHAR(16777216),
                VAR:actualdurationminutes::NUMBER,
                VAR:onholdtime::VARCHAR(16777216),
                VAR:_slaid_value::VARCHAR(16777216),
                VAR:leftvoicemail::VARCHAR(16777216),
                VAR:seriesid::VARCHAR(16777216),
                VAR:instancetypecode::VARCHAR(16777216),
                VAR:actualstart::NUMBER,
                VAR:exchangeitemid::VARCHAR(16777216),
                VAR:_transactioncurrencyid_value::VARCHAR(16777216),
                VAR:stageid::VARCHAR(16777216),
                VAR:deliveryprioritycode::VARCHAR(16777216),
                VAR:postponeactivityprocessinguntil::VARCHAR(16777216),
                VAR:senton::VARCHAR(16777216),
                VAR:_serviceid_value::VARCHAR(16777216),
                VAR:activityadditionalparams::VARCHAR(16777216),
                VAR:_modifiedonbehalfby_value::VARCHAR(16777216),
                VAR:exchangerate::NUMBER,
                VAR:community::VARCHAR(16777216),
                VAR:_slainvokedid_value::VARCHAR(16777216),
                VAR:utcconversiontimezonecode::VARCHAR(16777216),
                VAR:ismapiprivate::VARCHAR(16777216),
                VAR:processid::VARCHAR(16777216),
                VAR:_createdonbehalfby_value::VARCHAR(16777216),
                VAR:exchangeweblink::VARCHAR(16777216),
                VAR:lastonholdtime::VARCHAR(16777216),
                VAR:deliverylastattemptedon::VARCHAR(16777216),
                VAR:_sendermailboxid_value::VARCHAR(16777216),
                VAR:description::VARCHAR(16777216),
                VAR:traversedpath::VARCHAR(16777216),
                VAR:sortdate::VARCHAR(16777216),
                VAR:_owningteam_value::VARCHAR(16777216),
                VAR:msdyncrm_activityid::VARCHAR(16777216),
                VAR:overriddencreatedon::NUMBER,
                VAR:_msdyncrm_associatedcustomerjourneyiteration_value::VARCHAR(16777216),
                VAR:subcategory::VARCHAR(16777216),
                VAR:category::VARCHAR(16777216),
                VAR:crmtaskassigneduniqueid::VARCHAR(16777216),
                VAR:importsequencenumber::NUMBER,
                VAR:subscriptionid::VARCHAR(16777216),
                SYSDATE()
            FROM 
                RAW.DYN.LOAD_TASK_STREAM;
    COMMIT;
END