{% from 'macros/cms_audit.j2' import create_cms_audit_merge_task -%}
{% from 'macros/cms.j2' import convert_to_mastercountry_tz -%}

{{ create_cms_audit_merge_task(
        cms_audit_schema,
        load_cms_audit_schema,
        "offer_item_histories",
        [
        ('id', "var:Id::varchar"),
        ('offer_history_id', "var:OfferHistoryId::varchar"),
        ('action_type', "var:ActionType::varchar"),
        ('trigger_from', "var:TriggerFrom::varchar"),
        ('rate_id', "var:RateId::varchar"),
        ('rate_type', "var:RateType::varchar"),
        ('carrier_id', "var:CarrierId::varchar"),
        ('buying_rate', "var:BuyingRate::number(18, 2)"),
        ('selling_rate', "var:SellingRate::number(18, 2)"),
        ('is_cbt_rate', "var:IsCBTRate::boolean"),
        ('reference_ids', "var:ReferenceIds::varchar"),
        ('inserted_at', convert_to_mastercountry_tz("var:InsertedAt")),
        ('inserted_by', "var:InsertedBy::varchar"),
        ('created_by', "var:CreatedBy::varchar"),
        ('created_at', convert_to_mastercountry_tz("var:CreatedAt")),
        ('tenant_country_id', "var:TenantCountryId::varchar"),
        ],
        ('id', "var:Id::varchar"),
        cms_schema
    )
}}
