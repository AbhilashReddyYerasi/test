{% from 'macros/cms_audit.j2' import create_cms_audit_merge_task -%}
{% from 'macros/cms.j2' import convert_to_mastercountry_tz -%}

{{ create_cms_audit_merge_task(
        cms_audit_schema,
        load_cms_audit_schema,
        "offer_histories",
        [
        ('id', "var:Id::varchar"),
        ('transport_order_id', "var:TransportOrderId::varchar"),
        ('transport_route_id', "var:TransportRouteId::varchar"),
        ('shipment_number', "var:ShipmentNumber::varchar"),
        ('offer_type', "var:OfferType::varchar"),
        ('contract_rate_id', "var:ContractRateId::varchar"),
        ('contract_rate_type', "var:ContractRateType::varchar"),
        ('market_place_rate_id', "var:MarketplaceRateId::varchar"),
        ('market_place_rate_type', "var:MarketplaceRateType::varchar"),
        ('offer_remark', "var:OfferRemark::varchar"),
        ('reference_ids', "var:ReferenceIds::varchar"),
        ('trigger_from', "var:TriggerFrom::varchar"),
        ('tenant_id', "var:TenantId::varchar"),
        ('tenant_country_id', "var:TenantCountryId::varchar"),
        ('inserted_at', convert_to_mastercountry_tz("var:InsertedAt")),
        ('inserted_by', "var:InsertedBy::varchar"),
        ('created_by', "var:CreatedBy::varchar"),
        ('created_at', convert_to_mastercountry_tz("var:CreatedAt")),
        ('custom_rate_id', "var:CustomRateId::varchar"),
        ('custom_rate_type', "var:CustomRateType::varchar"),
        ],
        ('id', "var:Id::varchar"),
        cms_schema
    )
}}
